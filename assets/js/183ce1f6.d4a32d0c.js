"use strict";(globalThis.webpackChunkhumanoid_robotics_book=globalThis.webpackChunkhumanoid_robotics_book||[]).push([[8576],{6827:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"module1-ros2/chapter2","title":"ROS 2 Nodes and Topics: Communication in Robotics","description":"In the previous chapter, we introduced the fundamental concepts of ROS 2 architecture, including nodes and topics. This chapter will delve deeper into these two core elements, providing practical examples of how they facilitate communication within a robotic system using Python.","source":"@site/docs/module1-ros2/chapter2.md","sourceDirName":"module1-ros2","slug":"/module1-ros2/chapter2","permalink":"/physical-ai-humanoid-robotics-textbook/docs/module1-ros2/chapter2","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module1-ros2/chapter2.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Introduction to ROS 2: Overview and Architecture","permalink":"/physical-ai-humanoid-robotics-textbook/docs/module1-ros2/chapter1"},"next":{"title":"ROS 2 Services and Actions: Synchronous and Asynchronous Calls","permalink":"/physical-ai-humanoid-robotics-textbook/docs/module1-ros2/chapter3"}}');var i=s(4848),t=s(8453);const a={},o="ROS 2 Nodes and Topics: Communication in Robotics",c={},l=[{value:"Understanding Nodes",id:"understanding-nodes",level:2},{value:"Understanding Topics",id:"understanding-topics",level:2},{value:"Publish/Subscribe Model",id:"publishsubscribe-model",level:3},{value:"Message Types",id:"message-types",level:3},{value:"Python Example: Simple Publisher and Subscriber",id:"python-example-simple-publisher-and-subscriber",level:2},{value:"1. Create a ROS 2 Package",id:"1-create-a-ros-2-package",level:3},{value:"2. Implement the Publisher Node (talker)",id:"2-implement-the-publisher-node-talker",level:3},{value:"3. Implement the Subscriber Node (listener)",id:"3-implement-the-subscriber-node-listener",level:3},{value:"4. Update <code>setup.py</code>",id:"4-update-setuppy",level:3},{value:"5. Build and Run the Package",id:"5-build-and-run-the-package",level:3},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"ros-2-nodes-and-topics-communication-in-robotics",children:"ROS 2 Nodes and Topics: Communication in Robotics"})}),"\n",(0,i.jsx)(n.p,{children:"In the previous chapter, we introduced the fundamental concepts of ROS 2 architecture, including nodes and topics. This chapter will delve deeper into these two core elements, providing practical examples of how they facilitate communication within a robotic system using Python."}),"\n",(0,i.jsx)(n.h2,{id:"understanding-nodes",children:"Understanding Nodes"}),"\n",(0,i.jsx)(n.p,{children:"A ROS 2 node is an executable program that performs a specific task. Nodes are designed to be modular, allowing complex robotic systems to be broken down into smaller, manageable components. This modularity promotes reusability, simplifies development, and enhances system reliability."}),"\n",(0,i.jsx)(n.p,{children:"For example, a robot might have separate nodes for:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Reading sensor data (e.g., from a LiDAR or camera)."}),"\n",(0,i.jsx)(n.li,{children:"Processing sensor data (e.g., object detection, localization)."}),"\n",(0,i.jsx)(n.li,{children:"Controlling motors."}),"\n",(0,i.jsx)(n.li,{children:"Planning navigation paths."}),"\n",(0,i.jsx)(n.li,{children:"User interface interaction."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Each node is an independent process that communicates with other nodes through ROS 2's various communication mechanisms."}),"\n",(0,i.jsx)(n.h2,{id:"understanding-topics",children:"Understanding Topics"}),"\n",(0,i.jsx)(n.p,{children:"Topics are the most common way for nodes to exchange data in a ROS 2 system. They implement a publish/subscribe communication model, which is asynchronous and one-way."}),"\n",(0,i.jsx)(n.h3,{id:"publishsubscribe-model",children:"Publish/Subscribe Model"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Publisher"}),": A node that sends data to a named topic is called a publisher. It continuously or periodically publishes messages to a specific topic."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Subscriber"}),": A node that receives data from a named topic is called a subscriber. It listens for messages on a specific topic."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Nodes don't communicate directly with each other. Instead, they publish messages to or subscribe to messages from named topics. The ROS 2 middleware (DDS) handles the underlying routing of messages between publishers and subscribers."}),"\n",(0,i.jsx)(n.h3,{id:"message-types",children:"Message Types"}),"\n",(0,i.jsx)(n.p,{children:"Every topic has an associated message type. A message type defines the structure and data types of the information that can be sent over that topic. This strict typing ensures that publishers and subscribers agree on the format of the data, preventing misinterpretations."}),"\n",(0,i.jsxs)(n.p,{children:["For example, a message type for a robot's current position might include ",(0,i.jsx)(n.code,{children:"x"}),", ",(0,i.jsx)(n.code,{children:"y"}),", and ",(0,i.jsx)(n.code,{children:"z"})," coordinates, along with a timestamp."]}),"\n",(0,i.jsx)(n.h2,{id:"python-example-simple-publisher-and-subscriber",children:"Python Example: Simple Publisher and Subscriber"}),"\n",(0,i.jsx)(n.p,{children:'Let\'s create a simple ROS 2 example in Python where a "talker" node publishes a string message to a topic, and a "listener" node subscribes to that topic and prints the received message.'}),"\n",(0,i.jsx)(n.h3,{id:"1-create-a-ros-2-package",children:"1. Create a ROS 2 Package"}),"\n",(0,i.jsxs)(n.p,{children:["First, ensure you are in your ROS 2 workspace ",(0,i.jsx)(n.code,{children:"src"})," directory (e.g., ",(0,i.jsx)(n.code,{children:"~/ros2_ws/src"}),"). If you don't have a workspace, create one:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/ros2_ws/src\r\ncd ~/ros2_ws/src\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Now, create a new ROS 2 Python package called ",(0,i.jsx)(n.code,{children:"py_pubsub"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 pkg create --build-type ament_python py_pubsub\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-implement-the-publisher-node-talker",children:"2. Implement the Publisher Node (talker)"}),"\n",(0,i.jsxs)(n.p,{children:["Navigate into the ",(0,i.jsx)(n.code,{children:"py_pubsub"})," package directory:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd py_pubsub\r\nmkdir py_pubsub # Create a directory for Python modules within the package\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Create a new Python file named ",(0,i.jsx)(n.code,{children:"publisher_member_function.py"})," inside the ",(0,i.jsx)(n.code,{children:"py_pubsub"})," directory (",(0,i.jsx)(n.code,{children:"~/ros2_ws/src/py_pubsub/py_pubsub/publisher_member_function.py"}),"):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\n\r\nfrom std_msgs.msg import String\r\n\r\n\r\nclass MinimalPublisher(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('minimal_publisher')\r\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\r\n        timer_period = 0.5  # seconds\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = 'Hello ROS 2: %d' % self.i\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\r\n        self.i += 1\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    minimal_publisher = MinimalPublisher()\r\n\r\n    rclpy.spin(minimal_publisher)\r\n\r\n    # Destroy the node explicitly\r\n    # (optional - otherwise it will be done automatically\r\n    # when the garbage collector destroys the node object)\r\n    minimal_publisher.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-implement-the-subscriber-node-listener",children:"3. Implement the Subscriber Node (listener)"}),"\n",(0,i.jsxs)(n.p,{children:["Create a new Python file named ",(0,i.jsx)(n.code,{children:"subscriber_member_function.py"})," inside the same ",(0,i.jsx)(n.code,{children:"py_pubsub"})," directory (",(0,i.jsx)(n.code,{children:"~/ros2_ws/src/py_pubsub/py_pubsub/subscriber_member_function.py"}),"):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\n\r\nfrom std_msgs.msg import String\r\n\r\n\r\nclass MinimalSubscriber(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('minimal_subscriber')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'topic',\r\n            self.listener_callback,\r\n            10)\r\n        self.subscription  # prevent unused variable warning\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    minimal_subscriber = MinimalSubscriber()\r\n\r\n    rclpy.spin(minimal_subscriber)\r\n\r\n    # Destroy the node explicitly\r\n    # (optional - otherwise it will be done automatically\r\n    # when the garbage collector destroys the node object)\r\n    minimal_subscriber.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"4-update-setuppy",children:["4. Update ",(0,i.jsx)(n.code,{children:"setup.py"})]}),"\n",(0,i.jsxs)(n.p,{children:["Edit the ",(0,i.jsx)(n.code,{children:"setup.py"})," file in your ",(0,i.jsx)(n.code,{children:"py_pubsub"})," package (",(0,i.jsx)(n.code,{children:"~/ros2_ws/src/py_pubsub/setup.py"}),") to declare your executables:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from setuptools import find_packages, setup\r\n\r\npackage_name = 'py_pubsub'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='0.0.0',\r\n    packages=find_packages(exclude=['test']),\r\n    data_files=[\r\n        ('share/' + package_name, ['package.xml']),\r\n        ('share/' + package_name + '/launch', ['launch/pubsub_launch.py']), # Add this line\r\n    ],\r\n    install_requires=['setuptools'],\r\n    zip_safe=True,\r\n    maintainer='your_name', # Replace with your name\r\n    maintainer_email='your_email@example.com', # Replace with your email\r\n    description='ROS 2 Python publisher and subscriber example',\r\n    license='Apache-2.0', # Or your chosen license\r\n    tests_require=['pytest'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'talker = py_pubsub.publisher_member_function:main',\r\n            'listener = py_pubsub.subscriber_member_function:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"NOTE"}),": Remember to replace ",(0,i.jsx)(n.code,{children:"your_name"})," and ",(0,i.jsx)(n.code,{children:"your_email@example.com"})," with your actual information."]}),"\n",(0,i.jsx)(n.h3,{id:"5-build-and-run-the-package",children:"5. Build and Run the Package"}),"\n",(0,i.jsxs)(n.p,{children:["Navigate back to your workspace root (",(0,i.jsx)(n.code,{children:"~/ros2_ws/"}),") and build your package:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/\r\ncolcon build --packages-select py_pubsub\n"})}),"\n",(0,i.jsx)(n.p,{children:"After building, you need to source your workspace setup files so that ROS 2 can find your new executables:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:". install/setup.bash # On Linux\n"})}),"\n",(0,i.jsx)(n.p,{children:"Now, open two separate terminals."}),"\n",(0,i.jsx)(n.p,{children:"In the first terminal, run the talker node:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run py_pubsub talker\n"})}),"\n",(0,i.jsx)(n.p,{children:"In the second terminal, run the listener node:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run py_pubsub listener\n"})}),"\n",(0,i.jsx)(n.p,{children:'You should see the talker node publishing "Hello ROS 2: X" messages, and the listener node receiving and printing them, demonstrating successful node-to-node communication via a topic.'}),"\n",(0,i.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,i.jsx)(n.p,{children:"This chapter demonstrated how to create and implement ROS 2 nodes in Python that communicate using the publish/subscribe model via topics. Understanding this fundamental mechanism is key to building more complex robotic behaviors. The next chapter will explore services and actions, providing synchronous and goal-oriented communication patterns."})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var r=s(6540);const i={},t=r.createContext(i);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);